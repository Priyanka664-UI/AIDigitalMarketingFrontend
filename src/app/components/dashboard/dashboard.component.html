<div class="app-container">
  <!-- Toast Container -->
  <div class="toast-container">
    <div *ngFor="let toast of toasts" class="toast" [ngClass]="'toast-' + toast.type">
      <iconify-icon 
        [icon]="toast.type === 'success' ? 'lucide:check-circle' : toast.type === 'error' ? 'lucide:x-circle' : toast.type === 'warning' ? 'lucide:alert-triangle' : 'lucide:info'"
        style="font-size: 20px; margin-right: 8px;"></iconify-icon>
      {{ toast.message }}
    </div>
  </div>

  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo-icon">
        <iconify-icon icon="lucide:brain-circuit" style="font-size: 20px; color: white"></iconify-icon>
      </div>
      <div class="logo-text">MarketMind AI</div>
    </div>

    <nav class="nav-menu">
      <button class="nav-item" [class.active]="activeTab === 'dashboard'" (click)="activeTab = 'dashboard'">
        <div class="icon-container">
          <iconify-icon icon="lucide:layout-dashboard" style="font-size: 18px"></iconify-icon>
        </div>
        Dashboard
      </button>
      <button class="nav-item" [class.active]="activeTab === 'content'" (click)="activeTab = 'content'">
        <div class="icon-container">
          <iconify-icon icon="lucide:sparkles" style="font-size: 18px"></iconify-icon>
        </div>
        Content Generator
      </button>
      <button class="nav-item" [class.active]="activeTab === 'campaigns'" (click)="activeTab = 'campaigns'">
        <div class="icon-container">
          <iconify-icon icon="lucide:folder-kanban" style="font-size: 18px"></iconify-icon>
        </div>
        Campaign Manager
      </button>
      <button class="nav-item" [class.active]="activeTab === 'analytics'" (click)="activeTab = 'analytics'">
        <div class="icon-container">
          <iconify-icon icon="lucide:bar-chart-3" style="font-size: 18px"></iconify-icon>
        </div>
        Analytics
      </button>
      <button class="nav-item" [class.active]="activeTab === 'strategy'" (click)="activeTab = 'strategy'">
        <div class="icon-container">
          <iconify-icon icon="lucide:lightbulb" style="font-size: 18px"></iconify-icon>
        </div>
        Marketing Strategy
      </button>
      <button class="nav-item" [class.active]="activeTab === 'settings'" (click)="activeTab = 'settings'" (mouseenter)="showSettingsMenu = true" (mouseleave)="onSettingsLeave()">
        <div class="icon-container">
          <iconify-icon icon="lucide:settings" style="font-size: 18px"></iconify-icon>
        </div>
        Settings
        <div class="settings-dropdown" *ngIf="showSettingsMenu" (mouseenter)="cancelHideMenu()" (mouseleave)="onSettingsLeave()">
          <button class="dropdown-item" (click)="navigateToSettings('account')">
            <iconify-icon icon="lucide:user" style="font-size: 16px"></iconify-icon>
            Account & Business
          </button>
          <button class="dropdown-item" (click)="navigateToSettings('platforms')">
            <iconify-icon icon="lucide:link" style="font-size: 16px"></iconify-icon>
            Social Platforms
          </button>
          <button class="dropdown-item" (click)="navigateToSettings('ai')">
            <iconify-icon icon="lucide:sparkles" style="font-size: 16px"></iconify-icon>
            AI Preferences
          </button>
          <button class="dropdown-item" (click)="navigateToSettings('billing')">
            <iconify-icon icon="lucide:credit-card" style="font-size: 16px"></iconify-icon>
            Billing & Plans
          </button>
          <button class="dropdown-item" (click)="navigateToSettings('notifications')">
            <iconify-icon icon="lucide:bell" style="font-size: 16px"></iconify-icon>
            Notifications
          </button>
        </div>
      </button>
    </nav>

    <div class="sidebar-footer">
      <div class="user-profile" (click)="confirmLogout()">
        <div class="user-avatar-initials">{{ business?.businessName?.charAt(0) || 'U' }}</div>
        <div class="user-details">
          <div class="user-name">{{ business?.businessName }}</div>
          <span class="user-plan">{{ business?.tier || 'Pro Plan' }}</span>
        </div>
        <div
          style="margin-left: auto; width: 16px; height: 16px; display: flex; align-items: center; justify-content: center;">
          <iconify-icon icon="lucide:log-out" style="font-size: 16px; color: var(--muted-foreground)"></iconify-icon>
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Top Header -->
    <header class="header">
      <div>
        <h1 class="header-title">Welcome back, {{ getFirstName() }} üëã</h1>
        <p class="header-subtitle">Here's what's happening with your marketing campaigns today.</p>
      </div>
      <div class="header-actions">
        <button class="btn-icon">
          <iconify-icon icon="lucide:bell" style="font-size: 20px"></iconify-icon>
        </button>
        <button class="btn btn-primary" (click)="showCreateCampaign = true">
          <iconify-icon icon="lucide:plus" style="font-size: 16px; color: white"></iconify-icon>
          New Campaign
        </button>
      </div>
    </header>

    <!-- Dashboard View -->
    <div *ngIf="activeTab === 'dashboard'">
      <!-- Stats Grid -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-title">Total Posts Generated</span>
            <div class="stat-icon">
              <iconify-icon icon="lucide:file-text" style="font-size: 18px"></iconify-icon>
            </div>
          </div>
          <div class="stat-value">{{ dashboardStats.totalPosts }}</div>
          <div class="stat-trend">
            <iconify-icon icon="lucide:trending-up" style="font-size: 14px" class="trend-up"></iconify-icon>
            <span class="trend-up">{{ dashboardStats.postsTrend }}</span>
            <span style="color: var(--muted-foreground)">from last month</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-title">Avg. Engagement Rate</span>
            <div class="stat-icon">
              <iconify-icon icon="lucide:activity" style="font-size: 18px"></iconify-icon>
            </div>
          </div>
          <div class="stat-value">{{ dashboardStats.avgEngagementRate }}%</div>
          <div class="stat-trend">
            <iconify-icon icon="lucide:trending-up" style="font-size: 14px" class="trend-up"></iconify-icon>
            <span class="trend-up">{{ dashboardStats.engagementTrend }}</span>
            <span style="color: var(--muted-foreground)">from last month</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-title">Total Reach</span>
            <div class="stat-icon">
              <iconify-icon icon="lucide:share-2" style="font-size: 18px"></iconify-icon>
            </div>
          </div>
          <div class="stat-value">{{ dashboardStats.totalReach }}</div>
          <div class="stat-trend">
            <iconify-icon icon="lucide:minus" style="font-size: 14px" class="trend-neutral"></iconify-icon>
            <span class="trend-neutral">No change</span>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-title">AI Credits Remaining</span>
            <div class="stat-icon">
              <iconify-icon icon="lucide:zap" style="font-size: 18px"></iconify-icon>
            </div>
          </div>
          <div class="stat-value">{{ dashboardStats.aiCredits }}</div>
          <div class="stat-trend">
            <span style="color: var(--muted-foreground)">Resets in {{ dashboardStats.creditsResetDays }} days</span>
          </div>
        </div>
      </div>

      <!-- Audience Reach Chart - Full Width -->
      <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
          <h3 class="card-title" style="margin-bottom: 0">Audience Reach</h3>
          <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 13px">
            Last 7 Days
            <iconify-icon icon="lucide:chevron-down" style="font-size: 14px"></iconify-icon>
          </button>
        </div>
        <div class="chart-container" *ngIf="engagementAnalytics">
          <div *ngFor="let val of engagementAnalytics.reachGraph; let i = index" class="chart-bar"
            [class.primary]="i === 3 || i === 6" [style.height.%]="(val / 3000) * 100"></div>
        </div>
        <div class="chart-container" *ngIf="!engagementAnalytics">
          <div class="chart-bar" style="height: 40%"></div>
          <div class="chart-bar" style="height: 55%"></div>
          <div class="chart-bar" style="height: 45%"></div>
          <div class="chart-bar primary" style="height: 80%"></div>
          <div class="chart-bar" style="height: 60%"></div>
          <div class="chart-bar" style="height: 65%"></div>
          <div class="chart-bar primary" style="height: 90%"></div>
        </div>
        <div class="chart-labels">
          <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
        </div>
      </div>

      <!-- Main Dashboard Grid -->
      <div class="dashboard-grid">
        <div style="display: flex; flex-direction: column; gap: 24px">
          <!-- Recent Activity -->
          <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h3 class="card-title" style="margin-bottom: 0">Recent Activity</h3>
              <a href="#" style="color: var(--primary); text-decoration: none; font-size: 13px; font-weight: 500;"
                (click)="activeTab = 'analytics'">View all</a>
            </div>

            <div class="activity-list">
              <div *ngFor="let post of posts | slice:0:3" class="activity-item">
                <img
                  [src]="post.imageUrl || 'https://images.unsplash.com/photo-1550547660-d9450f859349?ixlib=rb-4.0.3&auto=format&fit=crop&w=300&q=80'"
                  alt="Post thumbnail" class="activity-img" />
                <div class="activity-content">
                  <div class="activity-header">
                    <div class="activity-platform">
                      <iconify-icon
                        [icon]="post.platform === 'INSTAGRAM' ? 'lucide:instagram' : post.platform === 'FACEBOOK' ? 'lucide:facebook' : 'lucide:linkedin'"
                        style="font-size: 14px"></iconify-icon>
                      {{ post.platform }}
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                      <span class="badge" [ngClass]="post.status.toLowerCase()">{{ post.status }}</span>
                      <button class="btn-icon" style="padding: 4px;" (click)="deletePost(post.id!)" title="Delete post">
                        <iconify-icon icon="lucide:trash-2" style="font-size: 14px; color: #ef4444;"></iconify-icon>
                      </button>
                    </div>
                  </div>
                  <p class="activity-text">{{ post.caption }}</p>
                  <div class="activity-meta">
                    <span>{{ post.scheduledTime | date:'short' }}</span>
                  </div>
                </div>
              </div>
              <div *ngIf="posts.length === 0"
                style="text-align: center; color: var(--muted-foreground); padding: 20px;">
                No recent activity.
              </div>
            </div>
          </div>

          <!-- Active Integrations -->
          <div class="card">
            <h3 class="card-title">Active Integrations</h3>
            <div class="integration-list">
              <div *ngFor="let platform of platformStatus" class="integration-item">
                <div class="integration-info">
                  <div class="integration-icon">
                    <iconify-icon [icon]="platform.icon" style="font-size: 18px"></iconify-icon>
                  </div>
                  <span class="integration-name">{{ platform.name }}</span>
                </div>
                <div class="integration-status" [class.disconnected]="!platform.connected">
                  <div class="status-dot" [class.disconnected]="!platform.connected"></div>
                  {{ platform.connected ? 'Connected' : 'Disconnected' }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Content Generator / AI View -->
    <div *ngIf="activeTab === 'content'" class="ai-sections">
      <!-- AI Image Generator Card -->
      <div class="ai-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h3 style="color: white;">üé® AI Image Generator</h3>
        <p style="color: rgba(255,255,255,0.9); margin-bottom: 20px;">Generate professional marketing images with AI</p>
        <form class="ai-form">
          <div class="form-group">
            <label style="color: white;">Image Prompt</label>
            <textarea 
              [(ngModel)]="imagePrompt" 
              name="imagePrompt"
              placeholder="Describe your marketing image... (e.g., Modern coffee shop with customers)"
              rows="3"
              style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);"
            ></textarea>
          </div>
          <button 
            type="button" 
            class="btn btn-primary" 
            style="width: 100%; background: white; color: #667eea; font-weight: 600;"
            (click)="generateAIImage()" 
            [disabled]="isGeneratingImage || !imagePrompt.trim()">
            {{ isGeneratingImage ? '‚è≥ Generating Image...' : '‚ú® Generate Image' }}
          </button>
        </form>

        <div *ngIf="generatedImage" style="margin-top: 24px; background: white; padding: 20px; border-radius: 12px;">
          <h4 style="color: #333; margin-bottom: 12px;">Generated Image:</h4>
          <img [src]="generatedImage" alt="Generated" style="width: 100%; border-radius: 8px; margin-bottom: 12px;" />
          <div style="display: flex; gap: 8px; flex-wrap: wrap;">
            <button class="btn btn-secondary" (click)="downloadImage()" style="flex: 1;">‚¨áÔ∏è Download</button>
            <button class="btn btn-secondary" (click)="copyImageUrl()" style="flex: 1;">üìã Copy URL</button>
            <button class="btn btn-secondary" (click)="saveToLibrary()" style="flex: 1;">üíæ Save</button>
          </div>
        </div>
      </div>

      <!-- AI Content Form -->
      <div class="ai-card">
        <h3>üß† AI Content Generator</h3>
        <form class="ai-form">
          <div class="form-group">
            <label>Product Name</label>
            <input type="text" [(ngModel)]="contentRequest.productName" name="productName"
              placeholder="Enter product/service name">
          </div>
          <div class="form-group">
            <label>Target Audience</label>
            <input type="text" [(ngModel)]="contentRequest.targetAudience" name="targetAudience"
              placeholder="e.g., Young professionals">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Tone</label>
              <select [(ngModel)]="contentRequest.tone" name="tone">
                <option value="PROFESSIONAL">Professional</option>
                <option value="FRIENDLY">Friendly</option>
                <option value="LUXURY">Luxury</option>
                <option value="CASUAL">Casual</option>
              </select>
            </div>
            <div class="form-group">
              <label>Goal</label>
              <select [(ngModel)]="contentRequest.goal" name="goal">
                <option value="SALES">Sales</option>
                <option value="AWARENESS">Awareness</option>
                <option value="ENGAGEMENT">Engagement</option>
              </select>
            </div>
            <div class="form-group">
              <label>Platform</label>
              <select [(ngModel)]="contentRequest.platform" name="platform">
                <option value="INSTAGRAM">Instagram</option>
                <option value="FACEBOOK">Facebook</option>
                <option value="LINKEDIN">LinkedIn</option>
                <option value="WHATSAPP">WhatsApp</option>
              </select>
            </div>
          </div>
          <button type="button" class="btn btn-primary" style="width: 100%; margin-top: 10px;"
            (click)="generateAIContentForm()" [disabled]="loading">
            {{ loading ? '‚è≥ Generating...' : '‚ú® Generate Content' }}
          </button>
        </form>

        <div *ngIf="generatedContent" class="results" style="margin-top: 24px;">
          <div *ngIf="generatedContent.captions" class="result-section">
            <h4>üìù Captions</h4>
            <div *ngFor="let caption of generatedContent.captions" class="result-item"
              style="padding: 10px; background: #f5f7fa; border-radius: 8px; margin-bottom: 10px;">
              <p>{{ caption }}</p>
              <button class="btn btn-secondary" style="padding: 4px 8px; font-size: 12px"
                (click)="useCaption(caption)">Use This</button>
            </div>
          </div>
          <div *ngIf="generatedContent.hashtags" class="result-section">
            <h4>#Ô∏è‚É£ Hashtags</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 8px; padding: 10px; background: #f5f7fa; border-radius: 8px;">
              <button *ngFor="let tag of generatedContent.hashtags" 
                class="btn btn-secondary" 
                style="padding: 6px 12px; font-size: 12px; border-radius: 20px;"
                (click)="useHashtag(tag)">
                {{ tag }}
              </button>
            </div>
            <button class="btn btn-secondary" style="margin-top: 8px; width: 100%;"
              (click)="useHashtags(generatedContent.hashtags)">Use All Hashtags</button>
          </div>
        </div>
      </div>

      <!-- Post Scheduler -->
      <div class="ai-card" id="post-scheduler">
        <h3>üìÖ Post Scheduler</h3>
        <form class="ai-form">
          <div class="form-group">
            <label>Campaign</label>
            <select [(ngModel)]="scheduleRequest.campaignId" name="campaignId" (change)="loadScheduledPosts()">
              <option [ngValue]="null">Select Campaign</option>
              <option *ngFor="let campaign of campaigns" [ngValue]="campaign.id">{{ campaign.name }}</option>
            </select>
          </div>
          <div class="form-group">
            <label>Platform</label>
            <select [(ngModel)]="scheduleRequest.platform" name="schedulePlatform">
              <option value="INSTAGRAM">Instagram üì∑</option>
              <option value="FACEBOOK">Facebook üë•</option>
              <option value="LINKEDIN">LinkedIn üíº</option>
              <option value="WHATSAPP">WhatsApp üí¨</option>
            </select>
          </div>
          <div class="form-group">
            <label>Caption</label>
            <textarea rows="4" [(ngModel)]="scheduleRequest.caption" name="caption"
              placeholder="Enter caption"></textarea>
          </div>
          <div class="form-group">
            <label>Hashtags</label>
            <input type="text" [(ngModel)]="scheduleRequest.hashtags" name="hashtags" placeholder="#example #hashtags">
          </div>
          <div class="form-group">
            <label>Image URL</label>
            <div style="display: flex; gap: 8px">
              <input type="text" [(ngModel)]="scheduleRequest.imageUrl" name="imageUrl" placeholder="https://..."
                style="flex: 1">
              <button type="button" class="btn btn-secondary" style="font-size: 12px;"
                (click)="activeTab = 'content'">Pick generated</button>
            </div>
          </div>
          <div class="form-group">
            <label>Schedule Date & Time</label>
            <input type="datetime-local" [(ngModel)]="scheduleRequest.scheduledTime" name="scheduledTime">
          </div>
          <button type="button" class="btn btn-primary" style="width: 100%; margin-top: 10px;" (click)="schedulePost()"
            [disabled]="loading || !scheduleRequest.campaignId">
            {{ loading ? '‚è≥ Scheduling...' : 'üìÖ Schedule Post' }}
          </button>
        </form>
      </div>


    </div>

    <!-- Analytics View -->
    <div *ngIf="activeTab === 'analytics'" class="analytics-sections">
      <!-- Platform Tabs -->
      <div class="platform-tabs" style="display: flex; gap: 12px; margin-bottom: 24px; border-bottom: 2px solid var(--border); padding-bottom: 12px;">
        <button class="platform-tab" [class.active]="selectedPlatform === 'all'" (click)="selectedPlatform = 'all'" style="padding: 8px 16px; border: none; background: none; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -14px;">
          All Platforms
        </button>
        <button class="platform-tab" [class.active]="selectedPlatform === 'INSTAGRAM'" (click)="selectedPlatform = 'INSTAGRAM'" style="padding: 8px 16px; border: none; background: none; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -14px;">
          üì∑ Instagram
        </button>
        <button class="platform-tab" [class.active]="selectedPlatform === 'FACEBOOK'" (click)="selectedPlatform = 'FACEBOOK'" style="padding: 8px 16px; border: none; background: none; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -14px;">
          üë• Facebook
        </button>
        <button class="platform-tab" [class.active]="selectedPlatform === 'LINKEDIN'" (click)="selectedPlatform = 'LINKEDIN'" style="padding: 8px 16px; border: none; background: none; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -14px;">
          üíº LinkedIn
        </button>
        <button class="platform-tab" [class.active]="selectedPlatform === 'WHATSAPP'" (click)="selectedPlatform = 'WHATSAPP'" style="padding: 8px 16px; border: none; background: none; cursor: pointer; font-weight: 500; border-bottom: 2px solid transparent; margin-bottom: -14px;">
          üí¨ WhatsApp
        </button>
      </div>

      <!-- Platform Posts Cards -->
      <div class="analytics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 24px;" *ngIf="selectedPlatform !== 'all'">
        <div class="analytics-card" *ngIf="selectedPlatform === 'INSTAGRAM'">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="display: flex; align-items: center; gap: 8px;">üì∑ Instagram Posts</h3>
            <button class="btn btn-secondary" style="padding: 4px 12px; font-size: 12px;" (click)="viewAllPosts('INSTAGRAM')">View All</button>
          </div>
          <div class="post-count" style="font-size: 32px; font-weight: bold; color: var(--primary); margin-bottom: 8px;">{{ getPostsByPlatform('INSTAGRAM').length }}</div>
          <p style="color: var(--muted-foreground); font-size: 14px;">Total Instagram posts</p>
        </div>

        <div class="analytics-card" *ngIf="selectedPlatform === 'FACEBOOK'">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="display: flex; align-items: center; gap: 8px;">üë• Facebook Posts</h3>
            <button class="btn btn-secondary" style="padding: 4px 12px; font-size: 12px;" (click)="viewAllPosts('FACEBOOK')">View All</button>
          </div>
          <div class="post-count" style="font-size: 32px; font-weight: bold; color: var(--primary); margin-bottom: 8px;">{{ getPostsByPlatform('FACEBOOK').length }}</div>
          <p style="color: var(--muted-foreground); font-size: 14px;">Total Facebook posts</p>
        </div>

        <div class="analytics-card" *ngIf="selectedPlatform === 'LINKEDIN'">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="display: flex; align-items: center; gap: 8px;">üíº LinkedIn Posts</h3>
            <button class="btn btn-secondary" style="padding: 4px 12px; font-size: 12px;" (click)="viewAllPosts('LINKEDIN')">View All</button>
          </div>
          <div class="post-count" style="font-size: 32px; font-weight: bold; color: var(--primary); margin-bottom: 8px;">{{ getPostsByPlatform('LINKEDIN').length }}</div>
          <p style="color: var(--muted-foreground); font-size: 14px;">Total LinkedIn posts</p>
        </div>

        <div class="analytics-card" *ngIf="selectedPlatform === 'WHATSAPP'">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3 style="display: flex; align-items: center; gap: 8px;">üí¨ WhatsApp Posts</h3>
            <button class="btn btn-secondary" style="padding: 4px 12px; font-size: 12px;" (click)="viewAllPosts('WHATSAPP')">View All</button>
          </div>
          <div class="post-count" style="font-size: 32px; font-weight: bold; color: var(--primary); margin-bottom: 8px;">{{ getPostsByPlatform('WHATSAPP').length }}</div>
          <p style="color: var(--muted-foreground); font-size: 14px;">Total WhatsApp posts</p>
        </div>
      </div>
      <div class="analytics-card">
        <h3>üìà Engagement Analytics</h3>
        <div class="analytics-items" *ngIf="engagementAnalytics">
          <div class="analytics-item">
            <span class="item-label">üìä Peak Reach</span>
            <span class="item-value">{{ engagementAnalytics.reachGraph[engagementAnalytics.reachGraph.length - 1] |
              number }}</span>
          </div>
          <div class="analytics-item">
            <span class="item-label">‚ù§Ô∏è Total Likes</span>
            <span class="item-value">{{ engagementAnalytics.totalLikes | number }}</span>
          </div>
          <div class="analytics-item">
            <span class="item-label">üí¨ Comments</span>
            <span class="item-value">{{ engagementAnalytics.totalComments | number }}</span>
          </div>
          <div class="analytics-item">
            <span class="item-label">üîó Avg. CTR</span>
            <span class="item-value">{{ engagementAnalytics.clickThroughRate }}%</span>
          </div>
        </div>
      </div>

      <div class="analytics-card">
        <h3>‚öñÔ∏è Platform Comparison</h3>
        <div class="analytics-items" *ngIf="platformComparison">
          <div class="platform-stats" *ngIf="selectedPlatform === 'all' || selectedPlatform === 'INSTAGRAM'">
            <h4 style="margin: 10px 0 5px 0; font-size: 14px; text-transform: capitalize;">instagram</h4>
            <div class="analytics-item">
              <span class="item-label">Posts:</span> {{ platformComparison.platforms['instagram']?.posts }}
            </div>
            <div class="analytics-item">
              <span class="item-label">Reach:</span> {{ platformComparison.platforms['instagram']?.reach | number }}
            </div>
          </div>
          <div class="platform-stats" *ngIf="selectedPlatform === 'all' || selectedPlatform === 'FACEBOOK'">
            <h4 style="margin: 10px 0 5px 0; font-size: 14px; text-transform: capitalize;">facebook</h4>
            <div class="analytics-item">
              <span class="item-label">Posts:</span> {{ platformComparison.platforms['facebook']?.posts }}
            </div>
            <div class="analytics-item">
              <span class="item-label">Reach:</span> {{ platformComparison.platforms['facebook']?.reach | number }}
            </div>
          </div>
          <div class="platform-stats" *ngIf="selectedPlatform === 'all' || selectedPlatform === 'LINKEDIN'">
            <h4 style="margin: 10px 0 5px 0; font-size: 14px; text-transform: capitalize;">linkedin</h4>
            <div class="analytics-item">
              <span class="item-label">Posts:</span> {{ platformComparison.platforms['linkedin']?.posts }}
            </div>
            <div class="analytics-item">
              <span class="item-label">Reach:</span> {{ platformComparison.platforms['linkedin']?.reach | number }}
            </div>
          </div>
          <div class="platform-stats" *ngIf="selectedPlatform === 'all' || selectedPlatform === 'WHATSAPP'">
            <h4 style="margin: 10px 0 5px 0; font-size: 14px; text-transform: capitalize;">whatsapp</h4>
            <div class="analytics-item">
              <span class="item-label">Posts:</span> {{ platformComparison.platforms['whatsapp']?.posts }}
            </div>
            <div class="analytics-item">
              <span class="item-label">Reach:</span> {{ platformComparison.platforms['whatsapp']?.reach | number }}
            </div>
          </div>
          <div class="analytics-item" style="margin-top: 15px; border-top: 1px solid var(--border); padding-top: 10px;">
            <span class="item-label">üìà Top Content:</span> Images ({{ platformComparison.contentTypePerformance.images
            }}%)
          </div>
        </div>
      </div>

      <div class="analytics-card">
        <h3>üìÑ Reports</h3>
        <div class="report-info" *ngIf="monthlyReport" style="margin-bottom: 20px;">
          <p><strong>Current Report:</strong> {{ monthlyReport.month }}</p>
          <p>Reach for this month showed a {{ (monthlyReport.totalReach / 100000) * 10 | number:'1.0-1' }}% increase.
          </p>
        </div>
        <div class="report-actions">
          <button class="btn btn-secondary" (click)="downloadImage()">üì• Download Monthly Report</button>
          <button class="btn btn-secondary">üìä Export CSV</button>
        </div>
      </div>
    </div>

    <!-- Campaign Manager View -->
    <div *ngIf="activeTab === 'campaigns'">
      <div class="card" style="margin-bottom: 24px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h3 class="card-title" style="margin-bottom: 0">üìã All Campaigns</h3>
          <button class="btn btn-primary" (click)="showCreateCampaign = true">
            <iconify-icon icon="lucide:plus" style="font-size: 16px; color: white"></iconify-icon>
            New Campaign
          </button>
        </div>
        
        <div *ngIf="campaigns.length === 0" style="text-align: center; padding: 40px; color: var(--muted-foreground);">
          <iconify-icon icon="lucide:folder-open" style="font-size: 48px; margin-bottom: 16px;"></iconify-icon>
          <p>No campaigns yet. Create your first campaign to get started!</p>
        </div>

        <div *ngIf="campaigns.length > 0" style="display: grid; gap: 16px;">
          <div *ngFor="let campaign of campaigns" class="campaign-card">
            <div class="campaign-header">
              <div>
                <h4 class="campaign-name">{{ campaign.name }}</h4>
                <p class="campaign-dates">{{ campaign.startDate | date:'mediumDate' }} - {{ campaign.endDate | date:'mediumDate' }}</p>
              </div>
              <span class="badge" [ngClass]="campaign.status.toLowerCase()">{{ campaign.status }}</span>
            </div>
            <div class="campaign-actions">
              <button class="btn btn-secondary" (click)="selectCampaign(campaign); activeTab = 'dashboard'">
                <iconify-icon icon="lucide:eye" style="font-size: 14px"></iconify-icon>
                View Posts
              </button>
              <button class="btn btn-secondary" (click)="selectCampaign(campaign); activeTab = 'analytics'">
                <iconify-icon icon="lucide:bar-chart" style="font-size: 14px"></iconify-icon>
                Analytics
              </button>
              <button class="btn btn-secondary" (click)="deleteCampaign(campaign.id!)">
                <iconify-icon icon="lucide:trash-2" style="font-size: 14px; color: #ef4444;"></iconify-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings -->
    <div *ngIf="activeTab === 'settings'">
      <app-settings [initialTab]="settingsTab"></app-settings>
    </div>

    <!-- Marketing Strategy -->
    <div *ngIf="activeTab === 'strategy'">
      <app-marketing-strategy></app-marketing-strategy>
    </div>

  </main>
  <!-- Create Campaign Modal -->
  <div class="modal" *ngIf="showCreateCampaign" (click)="showCreateCampaign = false">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>Create New Campaign</h2>
      <form (ngSubmit)="createCampaign()">
        <div class="form-group">
          <label>Campaign Name</label>
          <input type="text" [(ngModel)]="newCampaign.name" name="name" required>
        </div>
        <div class="form-group">
          <label>Start Date</label>
          <input type="date" [(ngModel)]="newCampaign.startDate" name="startDate" required>
        </div>
        <div class="form-group">
          <label>End Date</label>
          <input type="date" [(ngModel)]="newCampaign.endDate" name="endDate" required>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" (click)="showCreateCampaign = false">Cancel</button>
          <button type="submit" class="btn btn-primary">Create Campaign</button>
        </div>
      </form>
    </div>
  </div>

  <!-- View All Posts Modal -->
  <div class="modal" *ngIf="showAllPostsModal" (click)="showAllPostsModal = false">
    <div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;" (click)="$event.stopPropagation()">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2>{{ selectedPlatform }} Posts</h2>
        <button class="btn-icon" (click)="showAllPostsModal = false">
          <iconify-icon icon="lucide:x" style="font-size: 20px;"></iconify-icon>
        </button>
      </div>
      <div class="posts-grid" style="display: grid; gap: 16px;">
        <div *ngFor="let post of platformPosts[selectedPlatform] || getPostsByPlatform(selectedPlatform)" class="card" style="padding: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
            <div>
              <span class="badge" [ngClass]="post.status.toLowerCase()">{{ post.status }}</span>
              <p style="font-size: 12px; color: var(--muted-foreground); margin-top: 4px;">{{ post.scheduledTime | date:'medium' }}</p>
            </div>
            <button class="btn-icon" (click)="deletePost(post.id!)" title="Delete">
              <iconify-icon icon="lucide:trash-2" style="font-size: 16px; color: #ef4444;"></iconify-icon>
            </button>
          </div>
          <p style="margin-bottom: 12px;">{{ post.caption }}</p>
          <div style="display: flex; gap: 16px; font-size: 13px; color: var(--muted-foreground);">
            <span>‚ù§Ô∏è {{ post.likes }}</span>
            <span>üí¨ {{ post.comments }}</span>
            <span>üîÅ {{ post.shares }}</span>
            <span>üëÅÔ∏è {{ post.reach }}</span>
          </div>
        </div>
        <div *ngIf="(platformPosts[selectedPlatform] || getPostsByPlatform(selectedPlatform)).length === 0" style="text-align: center; padding: 40px; color: var(--muted-foreground);">
          No posts found for {{ selectedPlatform }}
        </div>
      </div>
    </div>
  </div>

  <!-- Logout Confirmation Modal -->
  <div class="modal" *ngIf="showLogoutConfirm" (click)="showLogoutConfirm = false">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>Confirm Logout</h2>
      <p style="color: var(--muted-foreground); margin: 16px 0;">Are you sure you want to log out?</p>
      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" (click)="showLogoutConfirm = false">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="logout()">Logout</button>
      </div>
    </div>
  </div>
</div>